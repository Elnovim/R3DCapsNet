Input du réseau : [batch_size * n_clips, size_clip, height, width, n_channel] ( = [?*10, 8, 120, 160, 3])
On garde cette forme jusqu'à la sortie du capsule network
Sortie du capsule flatten
Passé à du fully connected (1 ou 2 couches)
On reshape le vecteur de sortie en [batch_size, n_clips, size_last_fc] ( = [?, 10, size_last_fc])
On le passe à une couche LSTM qui fait son dépliage sur n_clips = 10.
(On récupère les états des portes pour test online postérieur.)
On reshape le tensor en [batch_size * n_clips, n_cells]
On passe à un FC sur le nombre de classe (= 25 ou 26 si no_gesture)
On reshape le tensor en [batch_size, n_clips, n_classes]
On passe à ctc_loss avec time_major = False mais voir SparseTensor label comment créer.